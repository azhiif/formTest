<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Add Staff</title>
  <style>body{font-family:Arial;padding:20px}label{display:block;margin:8px 0}input,textarea{width:100%;padding:6px}</style>
</head>
<body>
  <h2>Add Staff</h2>
  <form id="form">
    <label>Name <input name="name" required></label>
    <label>Phone 1 <input name="phone1" required></label>
    <label>Phone 2 <input name="phone2"></label>
    <label>Address <textarea name="address"></textarea></label>
    <label>Aadhaar <input name="adhaar"></label>
    <label>Salary <input name="salary" type="number" step="0.01"></label>
    <label>Photo URL <input name="photo_url" placeholder="https://..."></label>
    <label>Parents Name <input name="parents_name"></label>
    <label>Post <input name="post"></label>
    <label>District <input name="district"></label>
    <label>Email <input name="email" type="email"></label>
    <label>DOB <input name="dob" type="date"></label>
    <label>Spouse Name <input name="spouse_name"></label>
    <label>Work Location <input name="work_location"></label>
    <label>Department <input name="department"></label>
    <label>Joining Date <input name="joining_date" type="date"></label>

    <div style="margin-top:12px"><button type="submit">Save</button> <a href="index.html">Back</a></div>
  </form>

  <script src="supabase-config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    document.getElementById('form').addEventListener('submit', async e=>{
      e.preventDefault();
      const f=e.target;
      const payload = {
        name: f.name.value.trim(),
        phone1: f.phone1.value.trim(),
        phone2: f.phone2.value.trim() || null,
        address: f.address.value.trim() || null,
        adhaar: f.adhaar.value.trim() || null,
        salary: f.salary.value ? parseFloat(f.salary.value) : null,
        photo_url: f.photo_url.value.trim() || null,
        parents_name: f.parents_name.value.trim() || null,
        post: f.post.value.trim() || null,
        district: f.district.value.trim() || null,
        email: f.email.value.trim() || null,
        dob: f.dob.value || null,
        spouse_name: f.spouse_name.value.trim() || null,
        work_location: f.work_location.value.trim() || null,
        department: f.department.value.trim() || null,
        joining_date: f.joining_date.value || null
      };
      const { error } = await supabase.from('staff').insert([payload]).select();
      if (error) { alert('Error: '+error.message); console.error(error); }
      else { alert('Saved âœ“'); f.reset(); }
    });
  </script>
</body>
</html>
